(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{115:function(t,s,a){"use strict";a.r(s);var n=a(0),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"模块和包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块和包"}},[t._v("#")]),t._v(" 模块和包")]),t._v(" "),a("blockquote",[a("p",[t._v("python的模块都是天然的单例")])]),t._v(" "),a("h2",{attrs:{id:"模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块"}},[t._v("#")]),t._v(" 模块")]),t._v(" "),a("p",[t._v("import加载的模块分为四个通用类别：")]),t._v(" "),a("ul",[a("li",[t._v("使用python编写的代码（.py文件）")]),t._v(" "),a("li",[t._v("已被编译为共享库或DLL的C或C++扩展")]),t._v(" "),a("li",[t._v("包好一组模块的包")]),t._v(" "),a("li",[t._v("使用C编写并链接到python解释器的内置模块")])]),t._v(" "),a("p",[t._v("我们可以从"),a("code",[t._v("sys.modules")]),t._v("中找到当前已经加载的模块，"),a("br"),t._v(" "),a("code",[t._v("sys.modules")]),t._v("是一个字典，内部包含模块名与模块对象的映射，"),a("br"),t._v("\n该字典决定了导入模块时是否需要重新导入。")]),t._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("p",[t._v("自定义模块文件名"),a("code",[t._v("my_module.py")]),t._v(",模块名"),a("code",[t._v("my_module")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#my_module.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'from the my_module.py'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmoney "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("read1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my_module->read1->money'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("money"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("read2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my_module->read2 calling read1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    read1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("change")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("global")]),t._v(" money\n    money"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),a("p",[t._v("每个模块都是一个独立的名称空间，定义在这个模块中的函数，把这个模块的名称空间当做全局名称空间，"),a("br"),t._v("\n这样我们在编写自己的模块时，就不用担心我们定义在自己模块中全局变量会在被导入时，与使用者的全局变量冲突"),a("br"),t._v("\n同时模块也是单例类，多次导入，'from the my_module.py'也只被print一次。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#测试：执行my_module.change()操作的全局变量money仍然是my_module中的")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#demo.py")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" my_module\n\nmoney "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nmy_module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("change"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 改变的是my_module.money")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("money"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''\n执行结果：\nfrom the my_module.py\n1\n'''")]),t._v("\n")])])]),a("h3",{attrs:{id:"在一行导入多个模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在一行导入多个模块"}},[t._v("#")]),t._v(" 在一行导入多个模块")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" re\n")])])]),a("h3",{attrs:{id:"别名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#别名"}},[t._v("#")]),t._v(" 别名")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" my_module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" sm\n")])])]),a("h3",{attrs:{id:"from-import"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#from-import"}},[t._v("#")]),t._v(" from ... import...")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" my_module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" read1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" read2\n\nmy_module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#可用")]),t._v("\nread1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#可用")]),t._v("\n")])])]),a("p",[t._v("如果当前命名空间有重名read1或者read2，那么会有覆盖效果。")]),t._v(" "),a("h4",{attrs:{id:"导入多行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入多行"}},[t._v("#")]),t._v(" 导入多行")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" my_module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("read1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   read2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   money"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"别名-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#别名-2"}},[t._v("#")]),t._v(" 别名")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" my_module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" read1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" read\n")])])]),a("h4",{attrs:{id:"全部导入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全部导入"}},[t._v("#")]),t._v(" 全部导入")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" my_module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将模块my_module中所有的名字都导入到当前名称空间")]),t._v("\n")])])]),a("p",[t._v("此时需要在在"),a("code",[t._v("my_module.py")]),t._v("中新增一行")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("__all__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'money'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'read1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("这样在另外一个文件中用"),a("code",[t._v("from my_module import *")]),t._v("就这能导入列表中规定的两个名字")]),t._v(" "),a("h3",{attrs:{id:"模块的加载与修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块的加载与修改"}},[t._v("#")]),t._v(" 模块的加载与修改")]),t._v(" "),a("p",[t._v("每个模块相当于单例类，导入一次立被实例化，放入字典"),a("code",[t._v("sys.modules")]),t._v("中了。"),a("br"),t._v("\npython不支持重新加载或卸载之前导入的模块"),a("br"),t._v("\n如果只是你想交互测试的一个模块，使用"),a("code",[t._v("importlib.reload(modulename)")]),t._v("，"),a("br"),t._v("\n而且这只能用于测试环境。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#aa.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("func1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'func1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" importlib\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" aa\n \ntime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# importlib.reload(aa)")]),t._v("\naa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("在20秒的等待时间里，修改aa.py中func1的内容，等待test.py的结果。"),a("br"),t._v("\n打开importlib注释，重新测试")]),t._v(" "),a("h3",{attrs:{id:"把模块当做脚本执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#把模块当做脚本执行"}},[t._v("#")]),t._v(" 把模块当做脚本执行")]),t._v(" "),a("p",[t._v("我们可以通过模块的全局变量"),a("code",[t._v("__name__")]),t._v("来查看模块名："),a("br"),t._v("\n当做脚本运行："),a("br"),t._v(" "),a("code",[t._v("__name__")]),t._v("等于"),a("code",[t._v("'__main__'")]),a("br"),t._v("\n当做模块导入："),a("br"),t._v(" "),a("code",[t._v("__name__")]),t._v("= 模块名"),a("br"),t._v("\n作用：用来控制.py文件在不同的应用场景下执行不同的逻辑")]),t._v(" "),a("p",[a("code",[t._v("if __name__ == '__main__':")])]),t._v(" "),a("h3",{attrs:{id:"模块搜索路径"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块搜索路径"}},[t._v("#")]),t._v(" 模块搜索路径")]),t._v(" "),a("p",[t._v("python解释器在启动时会自动加载一些模块，可以使用"),a("code",[t._v("sys.modules")]),t._v("查看"),a("br"),t._v("\n模块的查找顺序是：内存中已经加载的模块->内置模块->sys.path路径中包含的模块"),a("br"),t._v("\n在初始化后，python程序可以修改"),a("code",[t._v("sys.path")]),t._v(",路径放到前面的优先于标准库被加载")]),t._v(" "),a("h3",{attrs:{id:"编译python文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译python文件"}},[t._v("#")]),t._v(" 编译python文件")]),t._v(" "),a("p",[t._v("为了提高加载模块的速度，强调强调强调：提高的是加载速度而绝非运行速度。"),a("br"),t._v("\npython解释器会在"),a("code",[t._v("__pycache__")]),t._v("目录中下缓存每个模块编译后的版本，"),a("br"),t._v("\n格式为：module.version.pyc。"),a("br"),t._v("\n通常会包含python的版本号。")]),t._v(" "),a("p",[t._v("例如，在CPython3.3版本下，"),a("br"),t._v(" "),a("code",[t._v("my_module.py")]),t._v("模块会被缓存成"),a("code",[t._v("__pycache__/my_module.cpython-33.pyc")]),t._v("。"),a("br"),t._v("\n这种命名规范保证了编译后的结果多版本共存。")]),t._v(" "),a("h3",{attrs:{id:"dir-函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dir-函数"}},[t._v("#")]),t._v(" "),a("code",[t._v("dir()")]),t._v("函数")]),t._v(" "),a("p",[t._v("内置函数"),a("code",[t._v("dir()")]),t._v("可以用来查找模块中定义的名字，返回一个有序字符串列表")]),t._v(" "),a("h2",{attrs:{id:"包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包"}},[t._v("#")]),t._v(" 包")]),t._v(" "),a("p",[t._v("包是一种通过使用"),a("code",[t._v(".模块名")]),t._v("来组织python模块名称空间的方式。")]),t._v(" "),a("ul",[a("li",[t._v("无论是import形式还是from...import形式，凡是在导入语句中（而不是在使用时）遇到带点的，都是关于包独有的导入语法，如"),a("code",[t._v("from moviepy.editor import *")])]),t._v(" "),a("li",[t._v("包是目录级的（文件夹级），包的本质就是一个包含"),a("code",[t._v("__init__.py")]),t._v("文件的目录")]),t._v(" "),a("li",[a("ul",[a("li",[t._v("import导入文件时，产生名称空间中的名字来源于文件，")]),t._v(" "),a("li",[t._v("import 包时，产生的名称空间的名字同样来源于文件，即包下的"),a("code",[t._v("__init__.py")]),t._v("，导入包本质就是在导入该文件")])])])]),t._v(" "),a("p",[a("strong",[t._v("强调：")])]),t._v(" "),a("p",[t._v("1. 而在python2中，包下没有"),a("code",[t._v("__init__.py")]),t._v("文件，import包会报错\n　　2. 创建包的目的不是为了运行，而是被导入使用，记住，包只是模块的一种形式而已，包即模块")]),t._v(" "),a("h3",{attrs:{id:"绝对导入和相对导入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#绝对导入和相对导入"}},[t._v("#")]),t._v(" 绝对导入和相对导入")]),t._v(" "),a("h4",{attrs:{id:"内部互调"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内部互调"}},[t._v("#")]),t._v(" 内部互调")]),t._v(" "),a("p",[t._v("我们的最顶级包glance是写给别人用的，(结构图见最下)"),a("br"),t._v("\n然后在glance包内部也会有彼此之间互相导入的需求，这时候就有绝对导入和相对导入两种方式：")]),t._v(" "),a("ul",[a("li",[t._v("绝对导入：以glance作为起始")]),t._v(" "),a("li",[t._v("相对导入：用"),a("code",[t._v(".")]),t._v("或者"),a("code",[t._v("..")]),t._v("的方式为起始（只能在一个包中使用，不能用于不同目录内）")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#绝对导入")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cmd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" manage\nmanage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#相对导入")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cmd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" manage\nmanage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("外部测试结果：注意一定要在于glance同级的文件中测试")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" versions \n")])])]),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("注意：")]),t._v(" "),a("p",[t._v("在使用pycharm时，有的情况会为你多做一些事情"),a("br"),t._v("\n因而在测试时，一定要回到命令行去执行")])]),t._v(" "),a("p",[a("strong",[a("code",[t._v("__init__.py")]),t._v("决定的外部用例")])]),t._v(" "),a("p",[t._v("单独导入包名称时，不会导入包中所有包含的所有子模块，"),a("br"),t._v("\n即不会自动导入同级所有目录和python文件(子模块)。"),a("br"),t._v("\n模块内方法的调用方式取决于各级的"),a("code",[t._v("__init__.py")]),t._v("文件。")]),t._v(" "),a("h4",{attrs:{id:"默认的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#默认的"}},[t._v("#")]),t._v(" 默认的")]),t._v(" "),a("p",[t._v("很多第三方模块的各级"),a("code",[t._v("__init__.py")]),t._v("文件是如下书写的")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#glance/__init__.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" cmd\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#glance/cmd/__init__.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" manage\n")])])]),a("p",[t._v("此时外部可以这样调用：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" glance\nglance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("manage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"惯例的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#惯例的"}},[t._v("#")]),t._v(" 惯例的")]),t._v(" "),a("p",[t._v("也可以这样书写使无论什么方式都可以调用：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("glance"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("                   \n├── __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n│                   __version__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v("\n│                   __all__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'api'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cmd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'db'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   \n├── api                  \n│   │\n│   ├── __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py   __all__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'policy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'versions'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n│   │                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" \n│   │\n│   ├── policy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n│   │\n│   └── versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_now_version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n│                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n│    \n├── cmd  \n│   │\n│   ├── __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\t  __all__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'manage'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n│   │\n│   └── manage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py    \n│   \n└── db           \n    │\n    ├── __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py   __all__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'models'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    │\n    └── models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n")])])]),a("p",[t._v("此时外部怎样调用都行：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" glance\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_now_version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_now_version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_now_version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v("\n")])])]),a("p",[t._v("也就是说，这里的"),a("code",[t._v("__init__.py")]),t._v("里写了"),a("br"),t._v(" "),a("code",[t._v("from .api import *")]),t._v(" 它的效果是含有 "),a("code",[t._v("from . import api")]),t._v(" 的"),a("br"),t._v("\n当多重调用方式有重名的时候，"),a("strong",[t._v("深度优先")]),t._v("："),a("br"),t._v("\n如果"),a("code",[t._v("get_now_version")]),t._v("函数就叫"),a("code",[t._v("versions")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" glance\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nAttributeError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("object")]),t._v(" has no attribute "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'versions'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nAttributeError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("object")]),t._v(" has no attribute "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'versions'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" glance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);