<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>事件相关 | nanarino note</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="shortcut icon" href="./favicon.ico">
    <meta name="description" content="super best match, are you ready">
    
    <link rel="preload" href="/markdown-note/assets/css/0.styles.500b7fdf.css" as="style"><link rel="preload" href="/markdown-note/assets/js/app.6ad9ad44.js" as="script"><link rel="preload" href="/markdown-note/assets/js/8.ae913670.js" as="script"><link rel="preload" href="/markdown-note/assets/js/1.5bc6bece.js" as="script"><link rel="preload" href="/markdown-note/assets/js/28.4e9627bc.js" as="script"><link rel="prefetch" href="/markdown-note/assets/js/10.5e947330.js"><link rel="prefetch" href="/markdown-note/assets/js/11.301d9dda.js"><link rel="prefetch" href="/markdown-note/assets/js/12.e4b6419c.js"><link rel="prefetch" href="/markdown-note/assets/js/13.84c13ead.js"><link rel="prefetch" href="/markdown-note/assets/js/14.da0e09d6.js"><link rel="prefetch" href="/markdown-note/assets/js/15.d6fb46c8.js"><link rel="prefetch" href="/markdown-note/assets/js/16.f9ff9ab3.js"><link rel="prefetch" href="/markdown-note/assets/js/17.8259891a.js"><link rel="prefetch" href="/markdown-note/assets/js/18.087a4d0c.js"><link rel="prefetch" href="/markdown-note/assets/js/19.c8528fa5.js"><link rel="prefetch" href="/markdown-note/assets/js/20.8863a63e.js"><link rel="prefetch" href="/markdown-note/assets/js/21.8847dc3b.js"><link rel="prefetch" href="/markdown-note/assets/js/22.16fec1c1.js"><link rel="prefetch" href="/markdown-note/assets/js/23.d9e3924f.js"><link rel="prefetch" href="/markdown-note/assets/js/24.bde81be3.js"><link rel="prefetch" href="/markdown-note/assets/js/25.1883a82a.js"><link rel="prefetch" href="/markdown-note/assets/js/26.f2f2bbf0.js"><link rel="prefetch" href="/markdown-note/assets/js/27.c7cda20f.js"><link rel="prefetch" href="/markdown-note/assets/js/29.c9afe55b.js"><link rel="prefetch" href="/markdown-note/assets/js/3.8040a9db.js"><link rel="prefetch" href="/markdown-note/assets/js/30.18a85a01.js"><link rel="prefetch" href="/markdown-note/assets/js/31.72c949fb.js"><link rel="prefetch" href="/markdown-note/assets/js/32.8a0cbbed.js"><link rel="prefetch" href="/markdown-note/assets/js/33.376710bc.js"><link rel="prefetch" href="/markdown-note/assets/js/34.af108730.js"><link rel="prefetch" href="/markdown-note/assets/js/35.eb43e941.js"><link rel="prefetch" href="/markdown-note/assets/js/36.0396717d.js"><link rel="prefetch" href="/markdown-note/assets/js/37.876cb87f.js"><link rel="prefetch" href="/markdown-note/assets/js/38.01f154cf.js"><link rel="prefetch" href="/markdown-note/assets/js/39.a8244dc6.js"><link rel="prefetch" href="/markdown-note/assets/js/4.98f50ccd.js"><link rel="prefetch" href="/markdown-note/assets/js/40.f41e8fc7.js"><link rel="prefetch" href="/markdown-note/assets/js/41.6a2cc3d7.js"><link rel="prefetch" href="/markdown-note/assets/js/42.0eaa973a.js"><link rel="prefetch" href="/markdown-note/assets/js/43.2907499f.js"><link rel="prefetch" href="/markdown-note/assets/js/44.ac4d1231.js"><link rel="prefetch" href="/markdown-note/assets/js/45.19c4b441.js"><link rel="prefetch" href="/markdown-note/assets/js/46.dd0ce2d7.js"><link rel="prefetch" href="/markdown-note/assets/js/47.0ec6dcc4.js"><link rel="prefetch" href="/markdown-note/assets/js/48.b6a57045.js"><link rel="prefetch" href="/markdown-note/assets/js/49.aada9f7d.js"><link rel="prefetch" href="/markdown-note/assets/js/5.ecff997d.js"><link rel="prefetch" href="/markdown-note/assets/js/50.a00306d8.js"><link rel="prefetch" href="/markdown-note/assets/js/51.2467c72f.js"><link rel="prefetch" href="/markdown-note/assets/js/52.c705a611.js"><link rel="prefetch" href="/markdown-note/assets/js/53.1bc7535a.js"><link rel="prefetch" href="/markdown-note/assets/js/54.632ff400.js"><link rel="prefetch" href="/markdown-note/assets/js/55.992916e5.js"><link rel="prefetch" href="/markdown-note/assets/js/56.d576950f.js"><link rel="prefetch" href="/markdown-note/assets/js/57.e59e6f1f.js"><link rel="prefetch" href="/markdown-note/assets/js/58.8e659869.js"><link rel="prefetch" href="/markdown-note/assets/js/59.50330523.js"><link rel="prefetch" href="/markdown-note/assets/js/6.b1cd3e37.js"><link rel="prefetch" href="/markdown-note/assets/js/60.4639274d.js"><link rel="prefetch" href="/markdown-note/assets/js/61.6cdfff18.js"><link rel="prefetch" href="/markdown-note/assets/js/62.d9c80f51.js"><link rel="prefetch" href="/markdown-note/assets/js/63.3e4901bd.js"><link rel="prefetch" href="/markdown-note/assets/js/64.a8ef9d4e.js"><link rel="prefetch" href="/markdown-note/assets/js/65.558af6af.js"><link rel="prefetch" href="/markdown-note/assets/js/66.a41b8b54.js"><link rel="prefetch" href="/markdown-note/assets/js/67.c5259626.js"><link rel="prefetch" href="/markdown-note/assets/js/68.2d151809.js"><link rel="prefetch" href="/markdown-note/assets/js/69.fc8451aa.js"><link rel="prefetch" href="/markdown-note/assets/js/7.f3f49ad4.js"><link rel="prefetch" href="/markdown-note/assets/js/70.4dcc9762.js"><link rel="prefetch" href="/markdown-note/assets/js/71.a0283465.js"><link rel="prefetch" href="/markdown-note/assets/js/72.0544692b.js"><link rel="prefetch" href="/markdown-note/assets/js/73.ee8ea4da.js"><link rel="prefetch" href="/markdown-note/assets/js/74.56a9b0ae.js"><link rel="prefetch" href="/markdown-note/assets/js/75.486b7d4f.js"><link rel="prefetch" href="/markdown-note/assets/js/76.73b2046c.js"><link rel="prefetch" href="/markdown-note/assets/js/77.c91b8cf2.js"><link rel="prefetch" href="/markdown-note/assets/js/78.627526b3.js"><link rel="prefetch" href="/markdown-note/assets/js/79.e76450e0.js"><link rel="prefetch" href="/markdown-note/assets/js/80.40749b69.js"><link rel="prefetch" href="/markdown-note/assets/js/81.f32e5545.js"><link rel="prefetch" href="/markdown-note/assets/js/82.3b3d5be0.js"><link rel="prefetch" href="/markdown-note/assets/js/83.3238f4e9.js"><link rel="prefetch" href="/markdown-note/assets/js/9.e196c9cf.js">
    <link rel="stylesheet" href="/markdown-note/assets/css/0.styles.500b7fdf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown-note/" class="home-link router-link-active"><!----> <span class="site-name">nanarino note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/markdown-note/js/" class="nav-link router-link-active">
  JavaScript
</a></div><div class="nav-item"><a href="/markdown-note/py/" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="about" class="dropdown-title"><span class="title">about</span> <span class="arrow down"></span></button> <button type="button" aria-label="about" class="mobile-dropdown-title"><span class="title">about</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/nanarino" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/kogawananari" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/markdown-note/js/" class="nav-link router-link-active">
  JavaScript
</a></div><div class="nav-item"><a href="/markdown-note/py/" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="about" class="dropdown-title"><span class="title">about</span> <span class="arrow down"></span></button> <button type="button" aria-label="about" class="mobile-dropdown-title"><span class="title">about</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/nanarino" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/kogawananari" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>起步</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>函数和作用域</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>对象和方法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>BOM和DOM</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/markdown-note/js/18-DOM方法.html" class="sidebar-link">DOM方法</a></li><li><a href="/markdown-note/js/19-事件相关.html" class="active sidebar-link">事件相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#事件绑定" class="sidebar-link">事件绑定</a></li><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#事件监听" class="sidebar-link">事件监听</a></li><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#事件委托" class="sidebar-link">事件委托</a></li><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#冒泡和捕获" class="sidebar-link">冒泡和捕获</a></li><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#默认行为" class="sidebar-link">默认行为</a></li><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#事件对象" class="sidebar-link">事件对象</a></li><li class="sidebar-sub-header"><a href="/markdown-note/js/19-事件相关.html#兼容滚轮事件" class="sidebar-link">兼容滚轮事件</a></li></ul></li><li><a href="/markdown-note/js/20-BOM相关.html" class="sidebar-link">BOM相关</a></li><li><a href="/markdown-note/js/21-H5新增方法.html" class="sidebar-link">H5新增方法</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂项方法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WEB相关</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="事件相关"><a href="#事件相关" class="header-anchor">#</a> 事件相关</h1> <blockquote><p>&quot;IE8是最后一个还在使用自己的事件系统的浏览器。&quot;</p></blockquote> <p>在浏览器发生的事情统称为事件, 比如点击事件, 鼠标移动事件, 键盘事件, 点击事件, 请求事件,加载完成事件。</p> <p>事件对象（<code>event</code>）存储了事件触发的各种状态包括事件触发的主体对象,事件类型,事件触发的位置等等。</p> <p><code>event</code>在现代浏览器中即事件函数的第一个形参。其type属性, 是当前事件的名字。</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token comment">//&quot;click&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="事件绑定"><a href="#事件绑定" class="header-anchor">#</a> 事件绑定</h2> <p>绑定点击事件可以用（对象.<code>on</code>+事件名）的方式绑定事件，然后挂载上处理函数接受事件对象来进行处理。</p> <p>事件绑定的特点：</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//点击文档 打印1</span>
document<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//点击文档 打印2</span>
</code></pre></div><ul><li>事件绑定同一个对象只能给同一个事件绑定唯一一个事件处理函数.如果绑定第二个,第一个会被清除掉.因为本质上只是给对象的on事件属性上添加了一个函数。</li> <li>事件绑定函数的this指向当前调用(触发)事件的主体对象。</li> <li>在绑定事件之前, 事件属性的处理函数默认是null。</li> <li>清除事件的方式只需要讲此事件的触发函数改成null。</li></ul> <p>我们称<code>on</code>这种方式绑定的事件是<strong>DOM0级事件</strong>。</p> <ul><li><p>优点: 兼容所有的浏览器，因为它是最原始的事件，浏览器设计出来的那一天事件都是这么绑定的。</p></li> <li><p>缺点: 这种绑定事件的方法，一个对象只能绑定一个事件，不能绑定多个事件，否则会覆盖。</p></li></ul> <p>在很久之前事件直接写在标签内，现在的原生语法已不推荐这样做：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="事件监听"><a href="#事件监听" class="header-anchor">#</a> 事件监听</h2> <p>不直接写明处理的函数来响应事件，只需要做事件监听<code>addEventListener</code>。事件监听在节点对象的原型上。</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>生成的事件对象和事件绑定生成的对象是同一个。</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>window<span class="token punctuation">.</span>_a <span class="token operator">=</span> e<span class="token punctuation">}</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>window<span class="token punctuation">.</span>_b <span class="token operator">=</span> e<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//点击触发一次事件</span>
_a <span class="token operator">===</span> _b <span class="token comment">//true</span>
</code></pre></div><ul><li><p>事件监听接受两个参数( <strong>三个</strong> ) 第一个是需要监听的事件类型, 第二个是事件的触发的回调函数, 第三个是是否事件冒泡.</p></li> <li><p>事件类型不需要加on+事件类型,直接事件类型即可.</p></li> <li><p>一次可以绑定多个事件, 相互之间不影响.并且触发顺序就是绑定顺序</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//点击 打印1 2</span>
</code></pre></div></li> <li><p>事件监听处理函数的this指向当前调用(触发)事件的主体对象</p></li> <li><p>取消事件监听用对应的方式,<code>removeEventListener</code>,传入的参数要和添加的参数<strong>完全一致</strong></p></li></ul> <p>我们称这种事件的监听方式是<strong>DOM2级事件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span>
li<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> handle<span class="token punctuation">)</span>
<span class="token comment">// 点击li 触发</span>
li<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> handle<span class="token punctuation">)</span>
<span class="token comment">// 点击就没有反应了</span>
</code></pre></div><p>特殊的: 匿名事件处理函数是没法取消绑定事件的</p> <div class="language-js extra-class"><pre class="language-js"><code>li<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 点击触发</span>
li<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 关闭不了 因为此function不是彼function</span>
</code></pre></div><p>其中<code>addEventListener</code>不兼容低版本的IE浏览器</p> <p>在低版本的IE浏览器中使用: <code>attachEvent</code>和<code>detachEvent</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//不需要传入事件对象</span>
    <span class="token keyword">var</span> e <span class="token operator">=</span> window<span class="token punctuation">.</span>event<span class="token comment">//低版本IE中的事件对象</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">===</span>li<span class="token punctuation">)</span> <span class="token comment">//true</span>
<span class="token punctuation">}</span>
li<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">&quot;onclick&quot;</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
<span class="token comment">//添加</span>
li<span class="token punctuation">.</span><span class="token function">detachEvent</span><span class="token punctuation">(</span><span class="token string">&quot;onclick&quot;</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
<span class="token comment">//删除</span>
</code></pre></div><p>这里就有针对不同浏览器的兼容性封装,我们可以封装一个事件添加和删除的公共方法.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> EventUtil <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">addHandle</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> type<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span><span class="token punctuation">{</span>
            el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>attachEvent<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//attachEvent</span>
            el<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">&quot;on&quot;</span><span class="token operator">+</span>type<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment">// </span>
            el<span class="token punctuation">[</span><span class="token string">&quot;on&quot;</span><span class="token operator">+</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> handler
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">removeHandle</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> type<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>removeEventListener<span class="token punctuation">)</span><span class="token punctuation">{</span>
            el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>deleteEvent<span class="token punctuation">)</span><span class="token punctuation">{</span>
            el<span class="token punctuation">.</span><span class="token function">detachEvent</span><span class="token punctuation">(</span><span class="token string">&quot;on&quot;</span><span class="token operator">+</span>type<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            el<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token string">&quot;on&quot;</span><span class="token operator">+</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="事件委托"><a href="#事件委托" class="header-anchor">#</a> 事件委托</h2> <p>如果有大量dom对象需要绑定事件,并且事件的处理函数是同一个的时候，可以通过监听公共父元素的形式监听事件。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> ali <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;.list&gt;li&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//handle it</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token comment">// 这是事件源（事件对象的触发主体对象）</span>
<span class="token punctuation">}</span>
list<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
</code></pre></div><p>在事件处理函数fn中，可以通过判断事件源<code>e.target</code>，从而达到事件处理的目的.。</p> <p>实际运用中还可以结合事件冒泡使用。设计模式中称为代理模式</p> <h2 id="冒泡和捕获"><a href="#冒泡和捕获" class="header-anchor">#</a> 冒泡和捕获</h2> <p>当我们触发一个事件的时候：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>list<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">let</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.list&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.list li&quot;</span><span class="token punctuation">)</span>
    li<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;li触发&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    list<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;list触发&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如上代码在点击li的时候，无论绑定事件监听的添加先后顺序，事件的触发都是有先后顺序的。</p> <p>这里的触发顺序是<strong>默认是由里到外</strong>的。</p> <p>当这个事件发生的时候：</p> <ol><li>电脑然后将点击事件告知浏览器window</li> <li>浏览器window接受到点击事件，它会判断点击的是浏览器的工具按钮还是document中。</li> <li>document点击，是否在html中</li> <li>是不是在html里面的body中</li> <li>。。。</li> <li>点击到父级元素并点击到目标元素</li></ol> <p>以上是第一部分：<strong>事件捕获（capturing）</strong>，现在还没完。浏览器会从目标元素出发，进行第二轮事件触发</p> <ol><li>目标元素被点击，事件触发。通知父级元素</li> <li>父级元素触发点击，通知到父级的父级</li> <li>。。。</li> <li>到body</li> <li>到html</li> <li>到document</li> <li>浏览器window接受到触发事件</li></ol> <p>这是第二部分： <strong>事件冒泡（bubbling）</strong>。至此，一次点击事件完成。</p> <p><strong><code>addEventListener</code>方法一共可以接受三个参数：</strong></p> <p>第一个是事件类型，第二个是事件回调函数，第三个是事件在（捕获/冒泡）阶段触发。</p> <h2 id="默认行为"><a href="#默认行为" class="header-anchor">#</a> 默认行为</h2> <p>默认行为： 指的是浏览器的默认行为。</p> <p>当前页面中什么都没写的时候，点击某些标签或者右键或者滚动的时候，都会触发相应的事件，都会出现相应的效果。这就是浏览器的默认行为。</p> <p>有时候我们需要阻止默认行为，使用<code>e.preventDefault()</code>，这句不兼容，IE8以下的浏览器会不生效。在IE678的浏览器阻止默认行为的方法：<code>e.returnValue = false</code></p> <h3 id="阻止默认行为"><a href="#阻止默认行为" class="header-anchor">#</a> 阻止默认行为</h3> <p>阻止右键菜单事件：</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function-variable function">oncontextmenu</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">// 打开右键菜单的行为</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;右键点击触发&quot;</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 这句阻止了打开右键菜单的行为。</span>
    <span class="token comment">// e.returnValue = false //IE678的浏览器的操作</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当我们使用DOM0级事件的时候，可以使用<code>return false</code>来实现阻止默认行为，并且结束后续代码的执行。</p> <p>注意：</p> <ul><li><code>onmousedown</code>点击事件阻止不了鼠标右键显示浏览器菜单， <code>onmousedown</code>能触发右键的事件，但是右键的事件是<code>oncontextmenu</code></li> <li><code>onmousemove</code>鼠标移动触发后的默认会使得<code>onmousedown</code> <code>onmouseup</code>在很短一段时间内无法触发。</li></ul> <h3 id="阻止事件冒泡"><a href="#阻止事件冒泡" class="header-anchor">#</a> 阻止事件冒泡</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>stopPropagation<span class="token punctuation">)</span><span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    e<span class="token punctuation">.</span>cancelBubbse <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="事件对象"><a href="#事件对象" class="header-anchor">#</a> 事件对象</h2> <p>不管是DOM0级事件还是DOM2级事件都会传入一个<code>event</code>对象.</p> <p>这个对象包含了事件的相关信息. 包括触发事件的元素,事件类型等.</p> <p>所有浏览器都有事件对象但是支持方式不同,存在兼容性问题.</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>event<span class="token comment">//低版本ie</span>
</code></pre></div><table><thead><tr><th>属性名</th> <th>值</th> <th>含义</th></tr></thead> <tbody><tr><td>bubbles</td> <td>布尔型</td> <td>true表示冒泡，false表示不冒泡</td></tr> <tr><td>cancelable</td> <td>布尔型</td> <td>是否可以取消事件的默认行为</td></tr> <tr><td>currentTarget</td> <td>元素对象</td> <td>其事件处理程序当前正在处理事件的那个元素</td></tr> <tr><td>eventPhase</td> <td>数值</td> <td>1表示捕获阶段；2表示“目标阶段”；3：冒泡阶段</td></tr> <tr><td>preventDefault</td> <td>函数</td> <td>执行，就取消事件默认行为，当cancelable为true才行</td></tr> <tr><td>stopImmediatePropagation</td> <td>函数</td> <td>取消后续捕获或冒泡。阻止任何事件处理程序</td></tr> <tr><td>stopPropagation</td> <td>函数</td> <td>取消后续捕获或冒泡。</td></tr> <tr><td>taget</td> <td>元素对象</td> <td>事件的目标</td></tr> <tr><td>trusted</td> <td>布尔型</td> <td>是否是浏览器生成的事件</td></tr> <tr><td>type</td> <td>字符串</td> <td>被触发的事件的类型</td></tr></tbody></table> <p>在事件回调中，this等同于currentTarget，而target只是包含事件的实际目标。如果事件处理函数正好在点击事件触发的对象中，这几个东西是同一个。</p> <p>在IE事件对象中如果是DOM0级绑定的事件。在window对象下可以访问这个属性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelelctor</span><span class="token punctuation">(</span><span class="token string">&quot;.btn&quot;</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> event <span class="token operator">=</span> window<span class="token punctuation">.</span>event
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果是<code>attachEvent</code>添加的，会有event参数传入函数。和<code>addeventLlistener</code>一致</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelelctor</span><span class="token punctuation">(</span><span class="token string">&quot;.btn&quot;</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>额外或者不同的属性如下：</p> <table><thead><tr><th>属性名</th> <th>值</th> <th>含义</th></tr></thead> <tbody><tr><td>cancelBubble</td> <td>布尔</td> <td>默认false，可否取消事件冒泡，等同于stopPropagation()</td></tr> <tr><td>returnValue</td> <td>布尔</td> <td>默认为true，设置为false就是取消事件默认行为，等同于preventDefault()</td></tr> <tr><td>srcElement</td> <td>元素</td> <td>事件目标，等同于target</td></tr> <tr><td>type</td> <td>字符串</td> <td>被触发事件的类型</td></tr></tbody></table> <p>浏览器事件对象的兼容性：</p> <p>之前我们写了事件绑定的兼容性写法，现在我们完成事件对象的整合。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> EventUtil <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">addHandler</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//见前文</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">removeHandle</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//见前文</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">getEvent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getTarget</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> e<span class="token punctuation">.</span>target <span class="token operator">||</span> e<span class="token punctuation">.</span>srcElement
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">preventDefault</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>preventDefault<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>returnValue <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">stopPropagation</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>stopPropagation<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>cancelBabulle <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>事件类型</strong>：</p> <ul><li>UI事件，当用户于页面上的元素交互的时候触发</li> <li>鼠标事件，当用户获得或失去焦点的时候触发 如<code>onclick</code>，<code>ondoubleclick</code></li> <li>滚动事件，当使用鼠标滚轮（或类似设备）的时候触发</li> <li>文本事件，当输入文本时触发</li> <li>键盘事件，当用户通过键盘在页面上执行操作的时候触发</li> <li>变动事件，当底层DOM结构发生变化时触发</li></ul> <p><strong>鼠标和键盘触发是分状态的.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mousedown&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;鼠标按下&quot;</span><span class="token punctuation">)</span><span class="token comment">//按下触发事件</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseup&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;鼠标抬起&quot;</span><span class="token punctuation">)</span><span class="token comment">//在此处抬起鼠标触发事件，和在哪按下没关系</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;鼠标点击&quot;</span><span class="token punctuation">)</span><span class="token comment">//在此处按下并且抬起鼠标触发事件，和时长没关系，在抬起鼠标瞬间触发。</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>键盘事件:</strong></p> <p>如果被绑定到具体标签上，则需要聚焦到当前目标，没有聚焦的不能触发，一般写到input标签中或者document中，或者window。</p> <p>在input标签中有输入法的时候也不能触发，只能写到<code>onchange</code>事件</p> <div class="language-js extra-class"><pre class="language-js"><code>input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;keydown&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//按下触发，长按连续触发</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keydown&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;keyup&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//每次抬起触发，没有长按效果</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keyup&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;keypress&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//按下触发，和keydown类似</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keypress&quot;</span><span class="token punctuation">)</span><span class="token comment">//ie和edge包括chromium内核的edge只有回车空格触发</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>其中，<code>keydown</code>事件和<code>keypress</code>事件在监输入的时候不能获取到实时的输入内容，会少最后一位，只有<code>keyup</code>可以获取。</p> <p>并且<code>keydown</code>的本质是监听按下事件，任何按键都能触发，但是<code>keypress</code>是监听输入。只有当用户有输入的时候才会触发，也就是说(<code>alt</code> <code>ctrl</code> <code>shift</code>等不会输入的)是不会触发<code>keypress</code>的。</p> <p>其中函数内部接受的参数e是事件对象，里面可以找寻到按键的信息等。</p> <p><strong>UI事件:</strong></p> <p>当页面加载完成的<code>load</code>事件，比如window和img的加载都会触发<code>load</code>事件</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;页面加载成功&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//有顺序</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;图片加载成功&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>调整页面大小滚动页面 （<code>resize</code>, <code>scroll</code>）</p> <p>对于这种高频触发的事件经常需要<strong>节流</strong> / <strong>防抖</strong>。</p> <p>节流：给事件设置只能触发一次，每隔一段时间重置使用次数。<br>
防抖：给事件设置冷却时间，冷却时间未到时触发会重置冷却时间。</p> <h2 id="兼容滚轮事件"><a href="#兼容滚轮事件" class="header-anchor">#</a> 兼容滚轮事件</h2> <p><code>onscroll</code> 滚动事件是监听浏览器的滚动条，只要滚动条的滑块发生变化，就会触发。</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onscroll</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//监听滚动位值发生变化</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;scrolling&quot;</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//这里是无法阻止滚动事件的</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onmousewheel</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//监听鼠标中键滑轮滚动，不监听滚动条拖拽</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;scrolling~&quot;</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//这里阻止了默认的滚动事件</span>
    <span class="token comment">//但是onmousewheel不兼容火狐，在火狐里要使用DOMMouseScroll</span>
    <span class="token comment">//DOMMouseScroll也只支持火狐。并且只支持DOM2级事件。</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在<code>onmousewheel</code>滚动事件中有属性: <code>deltaX</code>和<code>deltaY</code>表示x方向和y方向的滚动差值。下和右为正。</p> <p>兼容处理：</p> <ol><li>确定浏览器</li> <li>确定绑定方式</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mouseWheel</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> bool</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> type <span class="token operator">=</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>onmousewheel <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;mousewheel&quot;</span><span class="token operator">:</span><span class="token string">&quot;DOMMouseScroll&quot;</span>
    <span class="token comment">//对火狐浏览器判断</span>
    obj<span class="token punctuation">.</span>addEventListener<span class="token operator">?</span>obj<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> bool<span class="token punctuation">)</span><span class="token operator">:</span>obj<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">&quot;on&quot;</span><span class="token operator">+</span>type<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> bool<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>继续处理兼容性问题。<br>
目标： 获取滚动方向和滚动的值。<br>
关于滚动方向和滚动的值也需要统一。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">wheel</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;向 上 滚动了&quot;</span> <span class="token operator">+</span> d<span class="token punctuation">)</span>
       <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;向 下 滚动了&quot;</span> <span class="token operator">+</span> d<span class="token punctuation">)</span>
       <span class="token punctuation">}</span>
       <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">mouseWheel</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span>wheel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">mouseWheel</span><span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span>eFn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//真正的事件函数,用来处理统一的值</span>
    <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        e <span class="token operator">=</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>
        <span class="token comment">//滚动方向和数值保持一致，向上是正1，向下是-1</span>
        <span class="token keyword">var</span> direction <span class="token operator">=</span> e<span class="token punctuation">.</span>wheelDelta <span class="token operator">/</span> <span class="token number">120</span> <span class="token operator">||</span> <span class="token operator">-</span>e<span class="token punctuation">.</span>detail <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">eFn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>dom<span class="token punctuation">,</span> e<span class="token punctuation">,</span> direction<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span><span class="token punctuation">{</span>
                   e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                   e<span class="token punctuation">.</span>returnValue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//阻止默认事件</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span><span class="token comment">//改变函数的this指向</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> type<span class="token punctuation">;</span><span class="token comment">//事件名称</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>onmousewheel <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//主流和IE</span>
        type <span class="token operator">=</span> <span class="token string">&quot;mousewheel&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">//火狐</span>
        type <span class="token operator">=</span> <span class="token string">&quot;DOMMouseScroll&quot;</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span><span class="token punctuation">{</span>
        dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        dom<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">&quot;on&quot;</span><span class="token operator">+</span>type<span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 也比较重要, 实际</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/markdown-note/js/18-DOM方法.html" class="prev">
        DOM方法
      </a></span> <span class="next"><a href="/markdown-note/js/20-BOM相关.html">
        BOM相关
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/markdown-note/assets/js/app.6ad9ad44.js" defer></script><script src="/markdown-note/assets/js/8.ae913670.js" defer></script><script src="/markdown-note/assets/js/1.5bc6bece.js" defer></script><script src="/markdown-note/assets/js/28.4e9627bc.js" defer></script>
  </body>
</html>
