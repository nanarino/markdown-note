<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>文件处理</title>
    <meta name="description" content="">
    <link rel="shortcut icon" href="./favicon.ico">
    
    <link rel="preload" href="/markdown-note/assets/css/0.styles.bbfe0b79.css" as="style"><link rel="preload" href="/markdown-note/assets/js/app.a730857b.js" as="script"><link rel="preload" href="/markdown-note/assets/js/6.4d707832.js" as="script"><link rel="preload" href="/markdown-note/assets/js/1.19267a43.js" as="script"><link rel="preload" href="/markdown-note/assets/js/50.2cec459c.js" as="script"><link rel="prefetch" href="/markdown-note/assets/js/10.450906df.js"><link rel="prefetch" href="/markdown-note/assets/js/11.03a7ddb6.js"><link rel="prefetch" href="/markdown-note/assets/js/12.285e2227.js"><link rel="prefetch" href="/markdown-note/assets/js/13.97ba0a9a.js"><link rel="prefetch" href="/markdown-note/assets/js/14.ec3476fb.js"><link rel="prefetch" href="/markdown-note/assets/js/15.bbfd769a.js"><link rel="prefetch" href="/markdown-note/assets/js/16.579621fd.js"><link rel="prefetch" href="/markdown-note/assets/js/17.c9df6a57.js"><link rel="prefetch" href="/markdown-note/assets/js/18.5dfbe4e1.js"><link rel="prefetch" href="/markdown-note/assets/js/19.ebe955b7.js"><link rel="prefetch" href="/markdown-note/assets/js/20.defddc20.js"><link rel="prefetch" href="/markdown-note/assets/js/21.7d4d1fcf.js"><link rel="prefetch" href="/markdown-note/assets/js/22.2899262e.js"><link rel="prefetch" href="/markdown-note/assets/js/23.912e25d3.js"><link rel="prefetch" href="/markdown-note/assets/js/24.7c164a31.js"><link rel="prefetch" href="/markdown-note/assets/js/25.719e12c1.js"><link rel="prefetch" href="/markdown-note/assets/js/26.872fa261.js"><link rel="prefetch" href="/markdown-note/assets/js/27.f2e775cc.js"><link rel="prefetch" href="/markdown-note/assets/js/28.a459bb88.js"><link rel="prefetch" href="/markdown-note/assets/js/29.3a54dc76.js"><link rel="prefetch" href="/markdown-note/assets/js/3.ee307e01.js"><link rel="prefetch" href="/markdown-note/assets/js/30.dd3658bc.js"><link rel="prefetch" href="/markdown-note/assets/js/31.79702987.js"><link rel="prefetch" href="/markdown-note/assets/js/32.2e7dedd5.js"><link rel="prefetch" href="/markdown-note/assets/js/33.96b704bf.js"><link rel="prefetch" href="/markdown-note/assets/js/34.6a993818.js"><link rel="prefetch" href="/markdown-note/assets/js/35.20f1a93b.js"><link rel="prefetch" href="/markdown-note/assets/js/36.da9c6436.js"><link rel="prefetch" href="/markdown-note/assets/js/37.d549bbb2.js"><link rel="prefetch" href="/markdown-note/assets/js/38.32760f20.js"><link rel="prefetch" href="/markdown-note/assets/js/39.01a5e4c7.js"><link rel="prefetch" href="/markdown-note/assets/js/4.e5a448a1.js"><link rel="prefetch" href="/markdown-note/assets/js/40.3db3550a.js"><link rel="prefetch" href="/markdown-note/assets/js/41.eeab1495.js"><link rel="prefetch" href="/markdown-note/assets/js/42.cd0f2e3a.js"><link rel="prefetch" href="/markdown-note/assets/js/43.2dd76db4.js"><link rel="prefetch" href="/markdown-note/assets/js/44.c36f644e.js"><link rel="prefetch" href="/markdown-note/assets/js/45.d9ce19fc.js"><link rel="prefetch" href="/markdown-note/assets/js/46.70044768.js"><link rel="prefetch" href="/markdown-note/assets/js/47.8f8f07bc.js"><link rel="prefetch" href="/markdown-note/assets/js/48.a471ae00.js"><link rel="prefetch" href="/markdown-note/assets/js/49.399a9533.js"><link rel="prefetch" href="/markdown-note/assets/js/5.843fbad2.js"><link rel="prefetch" href="/markdown-note/assets/js/51.04ac969c.js"><link rel="prefetch" href="/markdown-note/assets/js/52.dd8e7b3c.js"><link rel="prefetch" href="/markdown-note/assets/js/53.5dcd3c45.js"><link rel="prefetch" href="/markdown-note/assets/js/54.7dafa28e.js"><link rel="prefetch" href="/markdown-note/assets/js/55.39aee5f1.js"><link rel="prefetch" href="/markdown-note/assets/js/56.2bad3fa8.js"><link rel="prefetch" href="/markdown-note/assets/js/57.c0b9b3f7.js"><link rel="prefetch" href="/markdown-note/assets/js/58.f7911fde.js"><link rel="prefetch" href="/markdown-note/assets/js/59.66850ea7.js"><link rel="prefetch" href="/markdown-note/assets/js/60.0cc12683.js"><link rel="prefetch" href="/markdown-note/assets/js/61.823dd71b.js"><link rel="prefetch" href="/markdown-note/assets/js/62.c778229e.js"><link rel="prefetch" href="/markdown-note/assets/js/63.9ed45b7d.js"><link rel="prefetch" href="/markdown-note/assets/js/64.837e466d.js"><link rel="prefetch" href="/markdown-note/assets/js/65.9ea5ad7a.js"><link rel="prefetch" href="/markdown-note/assets/js/66.d4981cb6.js"><link rel="prefetch" href="/markdown-note/assets/js/67.9b63aafc.js"><link rel="prefetch" href="/markdown-note/assets/js/68.eef5ae8b.js"><link rel="prefetch" href="/markdown-note/assets/js/69.bed8261f.js"><link rel="prefetch" href="/markdown-note/assets/js/7.d036849c.js"><link rel="prefetch" href="/markdown-note/assets/js/70.8811effb.js"><link rel="prefetch" href="/markdown-note/assets/js/71.ef4130a9.js"><link rel="prefetch" href="/markdown-note/assets/js/72.6781bfd3.js"><link rel="prefetch" href="/markdown-note/assets/js/73.c6de1c31.js"><link rel="prefetch" href="/markdown-note/assets/js/74.ec7c5d81.js"><link rel="prefetch" href="/markdown-note/assets/js/75.8d161c81.js"><link rel="prefetch" href="/markdown-note/assets/js/76.97a15235.js"><link rel="prefetch" href="/markdown-note/assets/js/77.85c4a4ed.js"><link rel="prefetch" href="/markdown-note/assets/js/78.92983aca.js"><link rel="prefetch" href="/markdown-note/assets/js/79.a2a42d7d.js"><link rel="prefetch" href="/markdown-note/assets/js/8.0a01bbb8.js"><link rel="prefetch" href="/markdown-note/assets/js/80.3d82ed7f.js"><link rel="prefetch" href="/markdown-note/assets/js/81.2dd53ef0.js"><link rel="prefetch" href="/markdown-note/assets/js/9.d5437aed.js">
    <link rel="stylesheet" href="/markdown-note/assets/css/0.styles.bbfe0b79.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown-note/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/markdown-note/js/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/markdown-note/py/" class="nav-link router-link-active">Python</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="about" class="dropdown-title"><span class="title">about</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/nanarino" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/kogawananari" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/markdown-note/js/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/markdown-note/py/" class="nav-link router-link-active">Python</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="about" class="dropdown-title"><span class="title">about</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/nanarino" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/kogawananari" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>起步</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据类型</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>函数</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/markdown-note/py/10-文件处理.html" class="active sidebar-link">文件处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown-note/py/10-文件处理.html#基本操作" class="sidebar-link">基本操作:</a></li><li class="sidebar-sub-header"><a href="/markdown-note/py/10-文件处理.html#内置函数open" class="sidebar-link">内置函数open()</a></li><li class="sidebar-sub-header"><a href="/markdown-note/py/10-文件处理.html#例题" class="sidebar-link">例题</a></li><li class="sidebar-sub-header"><a href="/markdown-note/py/10-文件处理.html#csv模块" class="sidebar-link">csv模块</a></li><li class="sidebar-sub-header"><a href="/markdown-note/py/10-文件处理.html#configparser模块" class="sidebar-link">configparser模块</a></li></ul></li><li><a href="/markdown-note/py/11-日志处理.html" class="sidebar-link">日志处理</a></li><li><a href="/markdown-note/py/12-函数和作用域.html" class="sidebar-link">函数和作用域</a></li><li><a href="/markdown-note/py/13-闭包和装饰器.html" class="sidebar-link">闭包和装饰器</a></li><li><a href="/markdown-note/py/14-递归和深拷贝.html" class="sidebar-link">递归和深拷贝</a></li><li><a href="/markdown-note/py/15-迭代器和生成器.html" class="sidebar-link">迭代器和生成器</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面向对象</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常用模块</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>并发编程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WEB相关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂项模块</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="文件处理"><a href="#文件处理" class="header-anchor">#</a> 文件处理</h1> <h2 id="基本操作"><a href="#基本操作" class="header-anchor">#</a> 基本操作:</h2> <ol><li>​    打开文件,得到文件句柄并赋值给变量</li> <li>​    通过句柄对文件进行操作</li> <li>​    关闭文件</li></ol> <div class="language-python extra-class"><pre class="language-python"><code>    f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;文件名&quot;</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token comment">#默认系统编码win下GBK</span>
    data<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="内置函数open"><a href="#内置函数open" class="header-anchor">#</a> 内置函数<code>open()</code></h2> <h3 id="可选模式"><a href="#可选模式" class="header-anchor">#</a> 可选模式:</h3> <ul><li><p>只读&quot;r&quot;(默认)</p></li> <li><p>只写&quot;w&quot; 如果文件存在则清空 不存在则新建</p></li> <li><p>可读可写&quot;r+&quot;</p></li> <li><p>追加写入&quot;a&quot;/&quot;a+&quot;  如<code>f=open(&quot;x.txt&quot;,&quot;a&quot;)</code></p></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#连续读字符 默认全部读完</span>
f<span class="token punctuation">.</span>readable<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#是否可读</span>
f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#连续读行</span>
f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#用列表返回每一行，成员的换行符不会被忽略</span>

f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token comment">#连续写 &quot;a&quot;模式在末尾追加</span>
f<span class="token punctuation">.</span>writeable<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#是否可写</span>
f<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token comment">#将列表连续写行，成员的换行符需要带上，如[&quot;aaa\n&quot;,&quot;bbb\n&quot;,&quot;ccc\n&quot;]</span>
</code></pre></div><h3 id="上下文管理"><a href="#上下文管理" class="header-anchor">#</a> 上下文管理</h3> <p>file对象实现了魔术方法<code>__enter__()</code> 和<code>__exit__()</code><br>
所以可以使用 <code>with open() as f</code>的写法</p> <h3 id="b模式"><a href="#b模式" class="header-anchor">#</a> b模式:</h3> <p>不能设置encoding
&quot;rb&quot; 读二进制</p> <div class="language-python extra-class"><pre class="language-python"><code>    data<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>​    &quot;wb&quot; 写二进制</p> <div class="language-python extra-class"><pre class="language-python"><code>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">&quot;内容&quot;</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>​    &quot;ab&quot;追加</p> <h3 id="其他参数"><a href="#其他参数" class="header-anchor">#</a> 其他参数</h3> <h4 id="encoding"><a href="#encoding" class="header-anchor">#</a> encoding</h4> <p>规定字符集</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'Latin-1'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="newline"><a href="#newline" class="header-anchor">#</a> newline</h4> <p>规定换行效果，默认适应操作系统<br>
对于用<code>\r\n</code>换行的系统，默认的<code>newline=&quot;\r&quot;</code>，故而只需要写入<code>&quot;\n&quot;</code>就相当于写入<code>&quot;\r\n&quot;</code><br>
另一方面，设置<code>newline=&quot;&quot;</code>才能使用<code>&quot;\r\n&quot;</code>换行，下面是官方参考手册里的解释：</p> <blockquote><p>In Python 2.X, it was required to open the csvfile with 'b' because the csv module does its own line termination handling.</p> <p>In Python 3.X, the csv module still does its own line termination handling, but still needs to know an encoding for Unicode strings. The correct way to open a csv file for writing is:</p> <div class="language-python extra-class"><pre class="language-python"><code>outputfile<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;out.csv&quot;</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre></div><p>encoding can be whatever you require, but newline='' suppresses text mode newline handling. On Windows, failing to do this will write \r\r\n file line endings instead of the correct \r\n. This is mentioned in the 3.X csv.reader documentation only, but csv.writer requires it as well.</p></blockquote> <p>对于下文即将介绍的csv模块也是如此。</p> <h3 id="其他方法"><a href="#其他方法" class="header-anchor">#</a> 其他方法</h3> <div class="language-python extra-class"><pre class="language-python"><code>f<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#刷新</span>
f<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#当前光标所在位置</span>
f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">int</span>默认<span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">#相对位置读字节</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
    负数倒着读,只能b模式下使用
    第二个参数:
        0代表从文件开头开始算起
        1代表从当前位置开始算起
        2代表从文件末尾算起。
    utf的3字节一个汉字 seek(3)相当于从头开始read(1)
&quot;&quot;&quot;</span>
f<span class="token punctuation">.</span>truncate<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token comment">#截取字节</span>
</code></pre></div><h3 id="循环文件的推荐方式"><a href="#循环文件的推荐方式" class="header-anchor">#</a> 循环文件的推荐方式</h3> <p>如:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">:</span>
    offs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">10</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span>offs<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
        data<span class="token operator">=</span>f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;最后一行是&quot;</span><span class="token operator">+</span>data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        offs<span class="token operator">*=</span><span class="token number">2</span>
</code></pre></div><p>不推荐:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><h2 id="例题"><a href="#例题" class="header-anchor">#</a> 例题</h2> <p>现在有一个<code>recensement.txt</code>文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">1</span> 	Paris 	<span class="token number">2229621</span>
<span class="token number">2</span> 	Marseille 	<span class="token number">855393</span>
<span class="token number">3</span> 	Lyon 	<span class="token number">500715</span>
<span class="token number">4</span> 	Toulouse 	<span class="token number">458298</span>
<span class="token number">5</span> 	Nice 	<span class="token number">342295</span>
<span class="token number">6</span> 	Nantes 	<span class="token number">292718</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
<span class="token number">70</span> 	Drancy 	<span class="token number">68241</span>
<span class="token number">71</span> 	Colmar 	<span class="token number">67956</span>
<span class="token number">72</span> 	Ajaccio 	<span class="token number">67507</span>
<span class="token number">73</span> 	Bourges 	<span class="token number">67189</span>
<span class="token number">74</span> 	Issy-les-Moulineaux 	<span class="token number">65662</span>
<span class="token number">75</span> 	Levallois-Perret 	<span class="token number">65264</span>
</code></pre></div><p>将它转化为一个字典再求出所有数的和</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> json    <span class="token comment">#引入json模块只是为了好看,后面会讲</span>
<span class="token keyword">import</span> functools    <span class="token comment">#高阶函数functools.reduce以后会讲</span>
<span class="token keyword">with</span> <span class="token builtin">open</span> <span class="token punctuation">(</span><span class="token string">'recensement.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
        k<span class="token operator">=</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;\t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        val<span class="token operator">=</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;\t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        dic<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>val
    <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>dic<span class="token punctuation">,</span>sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>separators<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    co<span class="token operator">=</span>functools<span class="token punctuation">.</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> r<span class="token punctuation">,</span>x<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">list</span><span class="token punctuation">(</span>dic<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;总和是%s&quot;</span><span class="token operator">%</span>co<span class="token punctuation">)</span>
</code></pre></div><p>执行结果</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;Aix-en-Provence &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;141545&quot;</span>,
  <span class="token string">&quot;Ajaccio &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;67507&quot;</span>,
  <span class="token string">&quot;Amiens &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;132699&quot;</span>,
  <span class="token string">&quot;Angers &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;150125&quot;</span>,
  <span class="token string">&quot;Antibes &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;75456&quot;</span>,
  <span class="token string">&quot;Argenteuil &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;106817&quot;</span>,
<span class="token comment">#......</span>
  <span class="token string">&quot;Toulouse &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;458298&quot;</span>,
  <span class="token string">&quot;Tourcoing &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;93974&quot;</span>,
  <span class="token string">&quot;Tours &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;134803&quot;</span>,
  <span class="token string">&quot;Versailles &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;85272&quot;</span>,
  <span class="token string">&quot;Villeurbanne &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;147192&quot;</span>,
  <span class="token string">&quot;Vitry-sur-Seine &quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;90075&quot;</span>
<span class="token punctuation">}</span>
总和是12470089
</code></pre></div><h2 id="csv模块"><a href="#csv模块" class="header-anchor">#</a> csv模块</h2> <p>内置模块 读写csv表格<br>
读取例子：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> csv
filename <span class="token operator">=</span> <span class="token string">'名单.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>写入例子：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> csv
filename <span class="token operator">=</span> <span class="token string">'单推名单.csv'</span>
csvFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csvFile<span class="token punctuation">)</span>

fileHeader <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;姓名&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;年龄&quot;</span><span class="token punctuation">)</span>
writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>fileHeader<span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;夏色祭&quot;</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">)</span>
writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

csvFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>正如前文中的描述，如果不设置<code>newline=''</code>，将会导致csv写入空行。</p> <h2 id="configparser模块"><a href="#configparser模块" class="header-anchor">#</a> configparser模块</h2> <p>内置模块 适用于操作配置文件<br>
常见文档格式如下：</p> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[DEFAULT]</span>
<span class="token constant">ServerAliveInterval</span> <span class="token attr-value"><span class="token punctuation">=</span> 45</span>
<span class="token constant">Compression</span> <span class="token attr-value"><span class="token punctuation">=</span> yes</span>
<span class="token constant">CompressionLevel</span> <span class="token attr-value"><span class="token punctuation">=</span> 9</span>
<span class="token constant">ForwardX11</span> <span class="token attr-value"><span class="token punctuation">=</span> yes</span>
  
<span class="token selector">[bitbucket.org]</span>
<span class="token constant">User</span> <span class="token attr-value"><span class="token punctuation">=</span> hg</span>
  
<span class="token selector">[topsecret.server.com]</span>
<span class="token constant">Port</span> <span class="token attr-value"><span class="token punctuation">=</span> 50022</span>
<span class="token constant">ForwardX11</span> <span class="token attr-value"><span class="token punctuation">=</span> no</span>
</code></pre></div><h3 id="生成"><a href="#生成" class="header-anchor">#</a> 生成</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> configparser

config <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
config<span class="token punctuation">[</span><span class="token string">&quot;DEFAULT&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'ServerAliveInterval'</span><span class="token punctuation">:</span> <span class="token string">'45'</span><span class="token punctuation">,</span>
                      <span class="token string">'Compression'</span><span class="token punctuation">:</span> <span class="token string">'yes'</span><span class="token punctuation">,</span>
                     <span class="token string">'CompressionLevel'</span><span class="token punctuation">:</span> <span class="token string">'9'</span><span class="token punctuation">,</span>
                     <span class="token string">'ForwardX11'</span><span class="token punctuation">:</span><span class="token string">'yes'</span>
                     <span class="token punctuation">}</span>
config<span class="token punctuation">[</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'User'</span><span class="token punctuation">:</span><span class="token string">'hg'</span><span class="token punctuation">}</span>
config<span class="token punctuation">[</span><span class="token string">'topsecret.server.com'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Host Port'</span><span class="token punctuation">:</span><span class="token string">'50022'</span><span class="token punctuation">,</span><span class="token string">'ForwardX11'</span><span class="token punctuation">:</span><span class="token string">'no'</span><span class="token punctuation">}</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'example.ini'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> configfile<span class="token punctuation">:</span>
   config<span class="token punctuation">.</span>write<span class="token punctuation">(</span>configfile<span class="token punctuation">)</span>
</code></pre></div><h3 id="读取"><a href="#读取" class="header-anchor">#</a> 读取</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> configparser
config <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
config<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">'example.ini'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># ['bitbucket.org', 'topsecret.server.com']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bytebong.com'</span> <span class="token keyword">in</span> config<span class="token punctuation">)</span> <span class="token comment"># False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bitbucket.org'</span> <span class="token keyword">in</span> config<span class="token punctuation">)</span> <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># hg</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'DEFAULT'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Compression'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># yes</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'topsecret.server.com'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ForwardX11'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#no</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>          <span class="token comment">#&lt;Section: bitbucket.org&gt;</span>

<span class="token keyword">for</span> key <span class="token keyword">in</span> config<span class="token punctuation">[</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     <span class="token comment"># 注意,有default会默认default的键</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>

config<span class="token punctuation">.</span>options<span class="token punctuation">(</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">)</span>  <span class="token comment"># 同for循环,找到'bitbucket.org'下所有键</span>
config<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">)</span>    <span class="token comment">#找到'bitbucket.org'下所有键值对</span>
config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">,</span><span class="token string">'compression'</span><span class="token punctuation">)</span> <span class="token comment">#获取'bitbucket.org'下key对应的value</span>
</code></pre></div><h3 id="修改"><a href="#修改" class="header-anchor">#</a> 修改</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> configparser
config <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
config<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">'example.ini'</span><span class="token punctuation">)</span>

<span class="token comment">#增加</span>
config<span class="token punctuation">.</span>add_section<span class="token punctuation">(</span><span class="token string">'yuan'</span><span class="token punctuation">)</span>
<span class="token comment">#删除</span>
config<span class="token punctuation">.</span>remove_section<span class="token punctuation">(</span><span class="token string">'bitbucket.org'</span><span class="token punctuation">)</span>  
config<span class="token punctuation">.</span>remove_option<span class="token punctuation">(</span><span class="token string">'topsecret.server.com'</span><span class="token punctuation">,</span><span class="token string">&quot;forwardx11&quot;</span><span class="token punctuation">)</span>
<span class="token comment">#修改</span>
config<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'topsecret.server.com'</span><span class="token punctuation">,</span><span class="token string">'k1'</span><span class="token punctuation">,</span><span class="token string">'11111'</span><span class="token punctuation">)</span>
config<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'yuan'</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">,</span><span class="token string">'22222'</span><span class="token punctuation">)</span>
<span class="token comment">#保存修改</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'new2.ini'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> configfile<span class="token punctuation">:</span>
    config<span class="token punctuation">.</span>write<span class="token punctuation">(</span>configfile<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/markdown-note/py/9-数据类型拓展.html" class="prev">数据类型拓展</a></span> <span class="next"><a href="/markdown-note/py/11-日志处理.html">日志处理</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/markdown-note/assets/js/app.a730857b.js" defer></script><script src="/markdown-note/assets/js/6.4d707832.js" defer></script><script src="/markdown-note/assets/js/1.19267a43.js" defer></script><script src="/markdown-note/assets/js/50.2cec459c.js" defer></script>
  </body>
</html>
