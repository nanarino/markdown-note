# 字符串格式化

Python的字符串格式化有两种方式

- %格式符方式
- format方式 



## `%`格式符

`%[(name)][flags][width].[precision]typecode`



- 
  (name)      可选，用于选择指定的key


```python
a = "%(name)s-----%(age)d "%{'name':'xx','age':20}
print(a)
```

- flags          可选，可供选择的值有：
  - *+       右对齐；正数前加正号，负数前加负号；*
  - *-        左对齐；正数前无符号，负数前加负号；*
  - *空格    右对齐；正数前加空格，负数前加负号；*
  - *0        右对齐；正数前无符号，负数前加负号；用0填充空白处*


- width         可选，占有宽度


name占10位，+,右对齐，age占10位，-，左对齐

```python
b = "%(name)+10s————————%(age)-10d————————"%{'name':'xx','age':20}
print(b)
```

 空格，右对齐

 0，用0填充空白处

```python
c = "------%(year) d******%(age)010d "%{'year':2016,'age':-20}
print(c)
```

- precision   可选，小数点后保留的位数 默认6位


```python
d = '--------%(p).2f'%{'p':1.23456}
d1 = '--------%(p)f'%{'p':1.23456}
print(d)    #--------1.23
print(d1)    #--------1.234560
```

- typecode    必选
  - %s    字符串 (采用str()的显示)
  - %r    字符串 (采用repr()的显示)
  - %c    单个字符
  - %b    二进制整数
  - %d    十进制整数
  - %i    十进制整数
  - %o    八进制整数
  - %x    十六进制整数
  - %e    指数 (基底写为e)
  - %E    指数 (基底写为E)
  - %f    浮点数
  - %F    浮点数，与上相同
  - %g    指数(e)或浮点数 (根据显示长度)
  - %G    指数(E)或浮点数 (根据显示长度)
  - %%    字符"%"



## 终端字体颜色

```python
"""
#格式：
　　设置颜色开始 ：\033[显示方式;前景色;背景色m
#说明：
前景色            背景色           颜色
---------------------------------------
30                40              黑色
31                41              红色
32                42              绿色
33                43              黃色
34                44              蓝色
35                45              紫红色
36                46              青蓝色
37                47              白色
显示方式           意义
-------------------------
0                终端默认设置
1                高亮显示
4                使用下划线
5                闪烁
7                反白显示
8                不可见
"""
#例子：
\033[1;31;40m    #1-高亮显示 31-前景色红色  40-背景色黑色
\033[0m          #采用终端默认设置，即取消颜色设置
```

可以使用第三方模块termcolor来简化语句：

```python
from termcolor import colored

print(colored("helloworld", "red"))
```

第三方模块在使用前需要用pip安装


::: warning 系统支持
Windows10以下无法解析颜色代码

使用termcolor模块也无效

可以使用第三方模块colorama来显示颜色
:::

colorama模块兼容更好：

```python
from colorama import  init, Fore

init(autoreset=False) #给True的时候print时无需+Fore.RESET
print(Fore.RED + "helloworld" + Fore.RESET)
```




## 内置函数`format()`

实现了魔术方法`__format__()`的对象都可以使用，返回字符串

以数字对象的格式化为例：

```python
>>> format(12,'0.3f') #保留3位小数
'12.000'
```

还可以用来数字的进制转化：

```python
>>> format(3,'b') #二进制转化
'11'
>>> format(3,'d') #十进制转化
'3'
>>> format(3,'n') #十进制转化
'3'
>>> format(3,'x') #十六进制转化
'3'
>>> format(12,'x')
'c'
>>> format(12,'o') #8进制转化
'14'
```





## 字符串方法`.format()`

模板字符串

涉及到函数的传参方式，将在后面章节介绍

```python
'  {}  {}  {}  '.format(a,b,c)     
' {0}  {1}  {2} '.format(a,b,c)
' {0}  {1}  {2} '.format(*[a,b,c])
'  {a}  {b}  {c}  '.format(a=a,b=b,c=c)
'  {a}  {b}  {c}  '.format(**{"a":a,"b":b,"c":c})
```

类型

```python
"""
   {:s} {:f}浮点默认6位
   {:b} {:o} 二进制/八进制
   {:d} 十进制整数
   {:x} {:X} 大/小写的十六进制
   {:%} 百分比
   {:g} 去掉小数点后多余0  默认最多6位有效数字 超过就科学计数法
   {!s}、{!a}以及{!r}，分别表示调用str、ascii以及repr方法
"""
```

```python
#精度调节:
def ma_num(strNum):
    return '{:.10g}'.format(float(strNum))
    
"""
'{:.10g}'的作用:去掉小数点后多余0  默认最多10位有效数字 超过就科学计数法
"""

>>> ma_num("12.00000")
'12'
>>> ma_num("12.00100")
'12.001'
>>> ma_num(12.0)
'12'
>>> ma_num(1)
'1'
>>> ma_num(1/9)
'0.1111111111'
>>> ma_num(10**9)
'1000000000'
>>> ma_num(10**10)
'1e+10'
```



## f字符串

在python3.6以上

可以直接使用**f字符串**的写法

用`f' {a} {b} {c} '`即可代替`' {a} {b} {c} '.format(a=a,b=b,c=c)`

在python3.8以上

**f字符串**中可以直接使用说明符`=`调试，

```python
>>> python = 3.8	
>>> f"{python=}"	
'python=3.8'
```



## 内置函数`str()`和`repr()`

`str()`不止是构造函数（`class`）实例化一个`str`对象，

`str(o)`它也是对参数对象进行魔术方法的调用：`o.__str__()`，将参数转换为了`str`对象

无论是`print(o)`，`f'{o}'`,  `"%s"%o`，它们都是对魔术方法 `o.__str__()`的调用



而`repr(o)`则是对魔术方法 `o.__repr__()`的调用，

它会以字面量的形式呈现对象，即字符串带有引号，列表变成`'['+ repr(成员) + ',]'`

`f'{o=}'`就相当于`f'o={repr(o)}'`