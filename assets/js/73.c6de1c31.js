(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{134:function(t,a,s){"use strict";s.r(a);var n=s(0),p=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"pyautogui模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pyautogui模块"}},[t._v("#")]),t._v(" PyAutoGUI模块")]),t._v(" "),s("p",[t._v("PyAutoGUI是一个纯Python的GUI自动化工具，其目的是可以用程序自动控制鼠标和键盘操作，多平台支持（Windows，OS X，Linux）。可以使用"),s("code",[t._v("pip")]),t._v("安装，Github上有"),s("a",{attrs:{href:"https://github.com/asweigart/pyautogui",target:"_blank",rel:"noopener noreferrer"}},[t._v("源代码"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("关于本模块")]),t._v(" "),s("p",[t._v("本笔记只记录基础，详细的API用法请左转其官方文档。")])]),t._v(" "),s("h2",{attrs:{id:"参考中文文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考中文文档"}},[t._v("#")]),t._v(" 参考中文文档")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://muxuezi.github.io/categories/pyautogui.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://muxuezi.github.io/categories/pyautogui.html"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"安装以及依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装以及依赖"}},[t._v("#")]),t._v(" 安装以及依赖")]),t._v(" "),s("p",[t._v("这里只说明在Windows系统下使用：")]),t._v(" "),s("p",[t._v("安装")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pyautogui\n")])])]),s("p",[t._v("下载完成后 包括：")]),t._v(" "),s("ul",[s("li",[t._v("pyautogui")]),t._v(" "),s("li",[t._v("pygetwindow")]),t._v(" "),s("li",[t._v("pymsgbox")]),t._v(" "),s("li",[t._v("pyrect")]),t._v(" "),s("li",[t._v("pyscreeze")]),t._v(" "),s("li",[t._v("pytweening")])]),t._v(" "),s("p",[t._v("...等目录")]),t._v(" "),s("p",[t._v("如果只使用github下载pyautogui目录 将会导致某些功能无法使用")]),t._v(" "),s("h2",{attrs:{id:"常用函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用函数"}},[t._v("#")]),t._v(" 常用函数")]),t._v(" "),s("h3",{attrs:{id:"先引入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#先引入"}},[t._v("#")]),t._v(" 先引入")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pyautogui\n")])])]),s("p",[t._v("弹窗")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'弹窗文字+OK按钮+Cancel按钮'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prompt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'弹窗文字+输入文字+OK按钮'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("confirm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'弹窗文字+输入文字+OK按钮+Cancel按钮'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("获取当前鼠标的坐标")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("获取当前屏幕的宽高，并让鼠标移到屏幕中央")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("h "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("moveTo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("让鼠标相对位移")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("moveRel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])])]),s("p",[t._v("判断(x,y)是否在屏幕上")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("122")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("244")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onScreen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("用num_seconds秒的时间把光标移动到(x, y)位置")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("moveTo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" duration"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("num_seconds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("鼠标点击（不传参数鼠标会原地点击）")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("moveToX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("moveToY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" clicks"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("num_of_clicks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" interval"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("secs_between_clicks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'left'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("鼠标按下和松开")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mouseDown"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("moveToX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("moveToY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'left'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mouseUp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("moveToX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("moveToY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'left'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("键盘按下和松开")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keyDown"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keyUp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("键盘输入")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("typewrite"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'left'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'backspace'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'enter'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'f1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" interval"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("secs_between_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("热键")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hotkey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ctrl'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 全选")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hotkey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ctrl'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 复制")]),t._v("\npyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hotkey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ctrl'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 粘贴")]),t._v("\n")])])]),s("p",[t._v("想要输入中文，需要使用读写粘贴板的第三方库"),s("code",[t._v("pyperclip")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pyperclip\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#读取")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pyperclip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("paste"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#写入")]),t._v("\npyperclip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'需要复制的文字'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("其他函数如 拖拽 滚轮等 比较少用 这里省略")]),t._v(" "),s("h2",{attrs:{id:"保护措施"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#保护措施"}},[t._v("#")]),t._v(" 保护措施")]),t._v(" "),s("p",[t._v("为了能够及时中断，PyAutoGUI提供了一个保护措施。"),s("br"),t._v("\n当"),s("code",[t._v("pyautogui.FAILSAFE = True")]),t._v("时，如果把鼠标光标在屏幕左上角，"),s("br"),t._v("\nPyAutoGUI函数就会产生"),s("code",[t._v("pyautogui.FailSafeException")]),t._v("异常。"),s("br"),t._v("\n如果失控了，需要中断PyAutoGUI函数，就把鼠标光标在屏幕左上角。"),s("br"),t._v("\n要禁用这个特性，就把"),s("code",[t._v("FAILSAFE")]),t._v("设置成"),s("code",[t._v("False")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FAILSAFE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n")])])]),s("h2",{attrs:{id:"截屏识别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#截屏识别"}},[t._v("#")]),t._v(" 截屏识别")]),t._v(" "),s("p",[t._v("寻找所有相似图片，返回一个生成器")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("locateAllOnScreen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo.png'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("识别屏幕，返回图片在屏幕上的中心XY轴坐标值"),s("br"),t._v("\n（只能识别一个，貌似上比左优先，找不到会抛出错误）")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pyautogui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("locateCenterOnScreen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'looks.png'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"其他注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他注意事项"}},[t._v("#")]),t._v(" 其他注意事项")]),t._v(" "),s("p",[t._v("测试某些游戏的时候，由于保护机制，鼠标无法在里面点击。")])])}),[],!1,null,null,null);a.default=p.exports}}]);