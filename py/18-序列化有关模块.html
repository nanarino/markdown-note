<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>序列化有关模块 | nanarino note</title>
    <meta name="description" content="a note I took with markdown">
    
    
    <link rel="preload" href="/markdown-note/assets/css/0.styles.447f505d.css" as="style"><link rel="preload" href="/markdown-note/assets/js/app.9fff5c40.js" as="script"><link rel="preload" href="/markdown-note/assets/js/6.3fa7f94b.js" as="script"><link rel="prefetch" href="/markdown-note/assets/js/10.8e85cf15.js"><link rel="prefetch" href="/markdown-note/assets/js/11.befe4248.js"><link rel="prefetch" href="/markdown-note/assets/js/12.f7cd383b.js"><link rel="prefetch" href="/markdown-note/assets/js/13.38cbb14c.js"><link rel="prefetch" href="/markdown-note/assets/js/14.26e3e81e.js"><link rel="prefetch" href="/markdown-note/assets/js/15.f1b6bea3.js"><link rel="prefetch" href="/markdown-note/assets/js/16.f091bb8c.js"><link rel="prefetch" href="/markdown-note/assets/js/17.7a22d023.js"><link rel="prefetch" href="/markdown-note/assets/js/18.59b1f62a.js"><link rel="prefetch" href="/markdown-note/assets/js/19.cb7d8146.js"><link rel="prefetch" href="/markdown-note/assets/js/2.11da7a94.js"><link rel="prefetch" href="/markdown-note/assets/js/20.f0242daa.js"><link rel="prefetch" href="/markdown-note/assets/js/21.fa3ba5da.js"><link rel="prefetch" href="/markdown-note/assets/js/22.283e00bb.js"><link rel="prefetch" href="/markdown-note/assets/js/23.b7f0dbb3.js"><link rel="prefetch" href="/markdown-note/assets/js/24.b86f4a34.js"><link rel="prefetch" href="/markdown-note/assets/js/25.d47e5e80.js"><link rel="prefetch" href="/markdown-note/assets/js/26.6343ad88.js"><link rel="prefetch" href="/markdown-note/assets/js/27.f80a9d63.js"><link rel="prefetch" href="/markdown-note/assets/js/28.e362d19f.js"><link rel="prefetch" href="/markdown-note/assets/js/29.c5218ff0.js"><link rel="prefetch" href="/markdown-note/assets/js/3.249571e8.js"><link rel="prefetch" href="/markdown-note/assets/js/30.a3490c46.js"><link rel="prefetch" href="/markdown-note/assets/js/31.2979d13e.js"><link rel="prefetch" href="/markdown-note/assets/js/32.82662b5c.js"><link rel="prefetch" href="/markdown-note/assets/js/33.4a70e37b.js"><link rel="prefetch" href="/markdown-note/assets/js/34.a3c4dafe.js"><link rel="prefetch" href="/markdown-note/assets/js/35.7d587dfb.js"><link rel="prefetch" href="/markdown-note/assets/js/36.9ec3bd61.js"><link rel="prefetch" href="/markdown-note/assets/js/37.103149b3.js"><link rel="prefetch" href="/markdown-note/assets/js/38.d6389bc9.js"><link rel="prefetch" href="/markdown-note/assets/js/39.b9ab678c.js"><link rel="prefetch" href="/markdown-note/assets/js/4.ac9f756f.js"><link rel="prefetch" href="/markdown-note/assets/js/40.de345d62.js"><link rel="prefetch" href="/markdown-note/assets/js/41.6499a4c4.js"><link rel="prefetch" href="/markdown-note/assets/js/42.e11ba283.js"><link rel="prefetch" href="/markdown-note/assets/js/43.81c4f6aa.js"><link rel="prefetch" href="/markdown-note/assets/js/44.598b051d.js"><link rel="prefetch" href="/markdown-note/assets/js/45.42f48a17.js"><link rel="prefetch" href="/markdown-note/assets/js/46.a4162e31.js"><link rel="prefetch" href="/markdown-note/assets/js/47.c321268b.js"><link rel="prefetch" href="/markdown-note/assets/js/48.96d0bf0d.js"><link rel="prefetch" href="/markdown-note/assets/js/49.8de7548c.js"><link rel="prefetch" href="/markdown-note/assets/js/5.8faa297c.js"><link rel="prefetch" href="/markdown-note/assets/js/50.01ff550c.js"><link rel="prefetch" href="/markdown-note/assets/js/51.7e319c9b.js"><link rel="prefetch" href="/markdown-note/assets/js/52.df096cdd.js"><link rel="prefetch" href="/markdown-note/assets/js/53.9396bb72.js"><link rel="prefetch" href="/markdown-note/assets/js/54.409865cc.js"><link rel="prefetch" href="/markdown-note/assets/js/55.32589aeb.js"><link rel="prefetch" href="/markdown-note/assets/js/56.4efbb75f.js"><link rel="prefetch" href="/markdown-note/assets/js/57.c47847a9.js"><link rel="prefetch" href="/markdown-note/assets/js/58.b8f2f9cb.js"><link rel="prefetch" href="/markdown-note/assets/js/59.dec67bd6.js"><link rel="prefetch" href="/markdown-note/assets/js/60.728ce7a4.js"><link rel="prefetch" href="/markdown-note/assets/js/7.9218be4d.js"><link rel="prefetch" href="/markdown-note/assets/js/8.3269e16e.js"><link rel="prefetch" href="/markdown-note/assets/js/9.1b085dce.js">
    <link rel="stylesheet" href="/markdown-note/assets/css/0.styles.447f505d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown-note/" class="home-link router-link-active"><!----> <span class="site-name">nanarino note</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/markdown-note/js/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/markdown-note/py/" class="nav-link router-link-active">Python</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Other</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/nanarino/markdown-note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.akokono.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mysite
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/markdown-note/js/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/markdown-note/py/" class="nav-link router-link-active">Python</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Other</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/nanarino/markdown-note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.akokono.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mysite
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>起步</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>数据类型</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>函数</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>常用模块</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/markdown-note/py/13-正则表达式.html" class="sidebar-link">正则表达式</a></li><li><a href="/markdown-note/py/14-collections模块.html" class="sidebar-link">collections模块</a></li><li><a href="/markdown-note/py/15-时间有关模块.html" class="sidebar-link">时间有关模块</a></li><li><a href="/markdown-note/py/16-random模块.html" class="sidebar-link">random模块</a></li><li><a href="/markdown-note/py/17-os模块和sys模块.html" class="sidebar-link">os模块和sys模块</a></li><li><a href="/markdown-note/py/18-序列化有关模块.html" class="active sidebar-link">序列化有关模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown-note/py/18-序列化有关模块.html#json模块" class="sidebar-link">json模块</a></li><li class="sidebar-sub-header"><a href="/markdown-note/py/18-序列化有关模块.html#选修-pickle-模块" class="sidebar-link">选修:pickle 模块</a></li><li class="sidebar-sub-header"><a href="/markdown-note/py/18-序列化有关模块.html#选修-shelve模块" class="sidebar-link">选修:shelve模块</a></li></ul></li><li><a href="/markdown-note/py/19-模块和包.html" class="sidebar-link">模块和包</a></li><li><a href="/markdown-note/py/20-异常抛出和捕获.html" class="sidebar-link">异常的抛出和捕获</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>面向对象</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>网络编程</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="序列化有关模块"><a href="#序列化有关模块" aria-hidden="true" class="header-anchor">#</a> 序列化有关模块</h1> <blockquote><p>将原本的字典、列表等内容转换成一个字符串的过程就叫做<strong>序列化</strong>。</p> <p><strong>序列化的目的</strong></p> <p>1、以某种存储形式使自定义<a href="https://baike.baidu.com/item/%E5%AF%B9%E8%B1%A1%E6%8C%81%E4%B9%85%E5%8C%96" target="_blank" rel="noopener noreferrer">对象持久化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>；</p> <p>2、将对象从一个地方传递到另一个地方。</p> <p>3、使程序更具维护性。</p> <p><img src="/markdown-note/assets/img/json1.e7301ceb.png" alt="img"></p></blockquote> <h2 id="json模块"><a href="#json模块" aria-hidden="true" class="header-anchor">#</a> json模块</h2> <p>json模块提供了四个功能：dumps、dump、loads、load</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> json
dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token string">'v1'</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token string">'v2'</span><span class="token punctuation">,</span><span class="token string">'k3'</span><span class="token punctuation">:</span><span class="token string">'v3'</span><span class="token punctuation">}</span>
str_dic <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>  <span class="token comment">#序列化：将一个字典转换成一个字符串</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span><span class="token punctuation">,</span>str_dic<span class="token punctuation">)</span>  <span class="token comment">#&lt;class 'str'&gt; {&quot;k3&quot;: &quot;v3&quot;, &quot;k1&quot;: &quot;v1&quot;, &quot;k2&quot;: &quot;v2&quot;}</span>
<span class="token comment">#注意，json转换完的字符串类型的字典中的字符串是由&quot;&quot;表示的</span>

dic2 <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span>  <span class="token comment">#反序列化：将一个字符串格式的字典转换成一个字典</span>
<span class="token comment">#注意，要用json的loads功能处理的字符串类型的字典中的字符串必须由&quot;&quot;表示</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>dic2<span class="token punctuation">)</span><span class="token punctuation">,</span>dic2<span class="token punctuation">)</span>  <span class="token comment">#&lt;class 'dict'&gt; {'k1': 'v1', 'k2': 'v2', 'k3': 'v3'}</span>


list_dic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token string">'v1'</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token string">'v2'</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
str_dic <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>list_dic<span class="token punctuation">)</span> <span class="token comment">#也可以处理嵌套的数据类型 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span><span class="token punctuation">,</span>str_dic<span class="token punctuation">)</span> <span class="token comment">#&lt;class 'str'&gt; [1, [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], 3, {&quot;k1&quot;: &quot;v1&quot;, &quot;k2&quot;: &quot;v2&quot;}]</span>
list_dic2 <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>list_dic2<span class="token punctuation">)</span><span class="token punctuation">,</span>list_dic2<span class="token punctuation">)</span> <span class="token comment">#&lt;class 'list'&gt; [1, ['a', 'b', 'c'], 3, {'k1': 'v1', 'k2': 'v2'}]</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> json
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'json_file'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>
dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token string">'v1'</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token string">'v2'</span><span class="token punctuation">,</span><span class="token string">'k3'</span><span class="token punctuation">:</span><span class="token string">'v3'</span><span class="token punctuation">}</span>
json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>dic<span class="token punctuation">,</span>f<span class="token punctuation">)</span>  <span class="token comment">#dump方法接收一个文件句柄，直接将字典转换成json字符串写入文件</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'json_file'</span><span class="token punctuation">)</span>
dic2 <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>  <span class="token comment">#load方法接收一个文件句柄，直接将文件中的json字符串转换成数据结构返回</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>dic2<span class="token punctuation">)</span><span class="token punctuation">,</span>dic2<span class="token punctuation">)</span>
</code></pre></div><p>ensure_ascii参数</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> json
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>
json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'国籍'</span><span class="token punctuation">:</span><span class="token string">'中国'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span>
ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'国籍'</span><span class="token punctuation">:</span><span class="token string">'中国'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ret<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'国籍'</span><span class="token punctuation">:</span><span class="token string">'美国'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>f<span class="token punctuation">,</span>ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'国籍'</span><span class="token punctuation">:</span><span class="token string">'美国'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ret<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>其他参数</p> <div class="language-python extra-class"><pre class="language-python"><code>Serialize obj to a JSON formatted <span class="token builtin">str</span><span class="token punctuation">.</span><span class="token punctuation">(</span>字符串表示的json对象<span class="token punctuation">)</span> 
Skipkeys：默认值是<span class="token boolean">False</span>，如果<span class="token builtin">dict</span>的keys内的数据不是python的基本类型<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span><span class="token builtin">unicode</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">long</span><span class="token punctuation">,</span><span class="token builtin">float</span><span class="token punctuation">,</span><span class="token builtin">bool</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>，设置为<span class="token boolean">False</span>时，就会报TypeError的错误。此时设置成<span class="token boolean">True</span>，则会跳过这类key 
ensure_ascii<span class="token punctuation">:</span>，当它为<span class="token boolean">True</span>的时候，所有非ASCII码字符显示为\uXXXX序列，只需在dump时将ensure_ascii设置为<span class="token boolean">False</span>即可，此时存入json的中文即可正常显示。<span class="token punctuation">)</span> 
If check_circular <span class="token keyword">is</span> false<span class="token punctuation">,</span> then the circular reference check <span class="token keyword">for</span> container types will be skipped <span class="token keyword">and</span> a circular reference will result <span class="token keyword">in</span> an OverflowError <span class="token punctuation">(</span><span class="token keyword">or</span> worse<span class="token punctuation">)</span><span class="token punctuation">.</span> 
If allow_nan <span class="token keyword">is</span> false<span class="token punctuation">,</span> then it will be a ValueError to serialize out of <span class="token builtin">range</span> <span class="token builtin">float</span> values <span class="token punctuation">(</span>nan<span class="token punctuation">,</span> inf<span class="token punctuation">,</span> <span class="token operator">-</span>inf<span class="token punctuation">)</span> <span class="token keyword">in</span> strict compliance of the JSON specification<span class="token punctuation">,</span> instead of using the JavaScript equivalents <span class="token punctuation">(</span>NaN<span class="token punctuation">,</span> Infinity<span class="token punctuation">,</span> <span class="token operator">-</span>Infinity<span class="token punctuation">)</span><span class="token punctuation">.</span> 
indent：应该是一个非负的整型，如果是<span class="token number">0</span>就是顶格分行显示，如果为空就是一行最紧凑显示，否则会换行且按照indent的数值显示前面的空白分行显示，这样打印出来的json数据也叫pretty<span class="token operator">-</span>printed json 
separators：分隔符，实际上是<span class="token punctuation">(</span>item_separator<span class="token punctuation">,</span> dict_separator<span class="token punctuation">)</span>的一个元组，默认的就是<span class="token punctuation">(</span>‘<span class="token punctuation">,</span>’<span class="token punctuation">,</span>’<span class="token punctuation">:</span>’<span class="token punctuation">)</span>；这表示dictionary内keys之间用“<span class="token punctuation">,</span>”隔开，而KEY和value之间用“：”隔开。 
default<span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">is</span> a function that should <span class="token keyword">return</span> a serializable version of obj <span class="token keyword">or</span> <span class="token keyword">raise</span> TypeError<span class="token punctuation">.</span> The default simply raises TypeError<span class="token punctuation">.</span> 
sort_keys：将数据根据keys的值进行排序。 
To use a custom JSONEncoder subclass <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> one that overrides the <span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span> method to serialize additional types<span class="token punctuation">)</span><span class="token punctuation">,</span> specify it <span class="token keyword">with</span> the cls kwarg<span class="token punctuation">;</span> otherwise JSONEncoder <span class="token keyword">is</span> used<span class="token punctuation">.</span>
</code></pre></div><p>格式化输出</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> json
data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'李华'</span><span class="token punctuation">,</span><span class="token string">'二愣子'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">:</span><span class="token string">'male'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">}</span>
json_dic2 <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>separators<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>json_dic2<span class="token punctuation">)</span>
</code></pre></div><h2 id="选修-pickle-模块"><a href="#选修-pickle-模块" aria-hidden="true" class="header-anchor">#</a> 选修:pickle 模块</h2> <p>pickle模块提供了四个功能：dumps、dump(序列化，存）、loads（反序列化，读）、load  （不仅可以序列化字典，列表...<strong>可以把python中任意的数据类型序列化</strong>）</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pickle
dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token string">'v1'</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token string">'v2'</span><span class="token punctuation">,</span><span class="token string">'k3'</span><span class="token punctuation">:</span><span class="token string">'v3'</span><span class="token punctuation">}</span>
str_dic <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span>  <span class="token comment">#一串二进制内容</span>

dic2 <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dic2<span class="token punctuation">)</span>    <span class="token comment">#字典</span>

<span class="token keyword">import</span> time
struct_time  <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token number">1000000000</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>struct_time<span class="token punctuation">)</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pickle_file'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span>
pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>struct_time<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pickle_file'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span>
struct_time2 <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>struct_time2<span class="token punctuation">.</span>tm_year<span class="token punctuation">)</span>
</code></pre></div><h2 id="选修-shelve模块"><a href="#选修-shelve模块" aria-hidden="true" class="header-anchor">#</a> 选修:shelve模块</h2> <p>shelve是一额简单的数据存储方案，它只有一个函数就是open()，这个函数接收一个参数就是文件名，并且文件名必须是.bat类型的。然后返回一个shelf对象，你可以用它来存储东西，它就像一个普通的字典，key必须为字符串，而值可以是python所支持的数据类型 ，当你存储完毕的时候，就调用close函数来关闭 ,</p> <p>把open方法的<strong>writeback</strong>参数的值赋为True，这样的话，你open后所有的内容都将在cache中，当你close的时候，将全部一次性写到硬盘里面。如果数据量不是很大的时候，建议这么做。</p> <p>写入:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> shelve
<span class="token keyword">import</span> datetime
 
info <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'bigberg'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">}</span>
name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Apoll'</span><span class="token punctuation">,</span> <span class="token string">'Zous'</span><span class="token punctuation">,</span> <span class="token string">'Luna'</span><span class="token punctuation">]</span>
t <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token keyword">with</span> shelve<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'shelve.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
  f<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> name  <span class="token comment"># 持久化列表</span>
  f<span class="token punctuation">[</span><span class="token string">'info'</span><span class="token punctuation">]</span> <span class="token operator">=</span> info     <span class="token comment"># 持久化字典</span>
  f<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> t      <span class="token comment"># 持久化时间类型</span>
</code></pre></div><p>执行代码后会生成3个文件：shelve.txt.bak、shelve.txt.dat、shelve.txt.dir。</p> <p>读取:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> shelve
 
<span class="token keyword">with</span> shelve<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'shelve.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
  n <span class="token operator">=</span> f<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
  i <span class="token operator">=</span> f<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">)</span>
  now <span class="token operator">=</span> f<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'time'</span><span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span>
 
<span class="token comment">#输出</span>
 
<span class="token punctuation">[</span><span class="token string">'Apoll'</span><span class="token punctuation">,</span> <span class="token string">'Zous'</span><span class="token punctuation">,</span> <span class="token string">'Luna'</span><span class="token punctuation">]</span>
<span class="token punctuation">{</span><span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'bigberg'</span><span class="token punctuation">}</span>
<span class="token number">2017</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">07</span><span class="token punctuation">:</span><span class="token number">34.865022</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/markdown-note/assets/js/app.9fff5c40.js" defer></script><script src="/markdown-note/assets/js/6.3fa7f94b.js" defer></script>
  </body>
</html>
